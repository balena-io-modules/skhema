{
    "type": "object",
    "properties": {
        "type": {
            "type": "string",
            "const": "thread"
        },
        "markers": {
            "type": "array",
            "items": {
                "type": "string",
                "anyOf": [
                    {
                        "pattern": "(^|\\+)(user-lucian|org-balena)($|\\+)"
                    },
                    {
                        "enum": [
                            "user-lucian",
                            "org-balena"
                        ]
                    }
                ]
            }
        }
    },
    "anyOf": [
        {
            "properties": {
                "active": {
                    "const": true,
                    "type": "boolean"
                }
            },
            "required": [
                "active"
            ],
            "type": "object",
            "anyOf": [
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "type": "object"
                        },
                        "type": {
                            "const": "type",
                            "type": "string"
                        }
                    },
                    "required": [
                        "slug",
                        "type",
                        "data"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "type": "object"
                        },
                        "type": {
                            "const": "link",
                            "type": "string"
                        }
                    },
                    "required": [
                        "type",
                        "data"
                    ],
                    "type": "object"
                },
                {
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "type": "object"
                        },
                        "id": {
                            "type": "string"
                        },
                        "type": {
                            "enum": [
                                "action",
                                "create",
                                "update"
                            ],
                            "type": "string"
                        }
                    },
                    "required": [
                        "id",
                        "type",
                        "data"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "properties": {
                                "actor": {
                                    "const": "e9135e65-3044-44d4-98a1-faf37a504ae9",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "actor"
                            ],
                            "type": "object"
                        },
                        "id": {
                            "type": "string"
                        },
                        "type": {
                            "const": "execute",
                            "type": "string"
                        }
                    },
                    "required": [
                        "type",
                        "data"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "properties": {
                                "actor": {
                                    "const": "e9135e65-3044-44d4-98a1-faf37a504ae9",
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        },
                        "id": {
                            "type": "string"
                        },
                        "type": {
                            "const": "action-request",
                            "type": "string"
                        }
                    },
                    "required": [
                        "id",
                        "type",
                        "data"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "slug": {
                            "const": "user-lucian",
                            "type": "string"
                        },
                        "type": {
                            "const": "user",
                            "type": "string"
                        }
                    },
                    "required": [
                        "slug",
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "properties": {
                                "actor": {
                                    "const": "e9135e65-3044-44d4-98a1-faf37a504ae9",
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        },
                        "id": {
                            "type": "string"
                        },
                        "type": {
                            "const": "session",
                            "type": "string"
                        }
                    },
                    "required": [
                        "data",
                        "id",
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "slug": {
                            "not": {
                                "anyOf": [
                                    {
                                        "pattern": "view-(read|write)-user.+"
                                    },
                                    {
                                        "enum": [
                                            "view-active",
                                            "view-active-triggered-actions",
                                            "view-non-executed-action-requests",
                                            "view-all-users"
                                        ]
                                    }
                                ]
                            },
                            "type": "string"
                        },
                        "type": {
                            "const": "view",
                            "type": "string"
                        }
                    },
                    "required": [
                        "slug",
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "properties": {
                                "actor": {
                                    "const": "e9135e65-3044-44d4-98a1-faf37a504ae9",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "actor"
                            ],
                            "type": "object"
                        },
                        "type": {
                            "const": "view",
                            "type": "string"
                        }
                    },
                    "required": [
                        "data",
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "id": {
                            "type": "string"
                        },
                        "type": {
                            "enum": [
                                "account",
                                "architecture-topic",
                                "issue",
                                "pull-request",
                                "thread",
                                "message",
                                "scratchpad-entry",
                                "support-thread",
                                "symptom",
                                "organizer",
                                "os-test-result",
                                "todo",
                                "triggered-action",
                                "whisper",
                                "org"
                            ],
                            "type": "string"
                        }
                    },
                    "required": [
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": true,
                    "properties": {
                        "data": {
                            "additionalProperties": true,
                            "properties": {
                                "actor": {
                                    "const": "e9135e65-3044-44d4-98a1-faf37a504ae9",
                                    "type": "string"
                                }
                            },
                            "required": [
                                "actor"
                            ],
                            "type": "object"
                        },
                        "type": {
                            "const": "subscription"
                        }
                    },
                    "required": [
                        "data",
                        "type"
                    ],
                    "type": "object"
                },
                {
                    "properties": {
                        "data": {
                            "additionalProperties": false,
                            "properties": {
                                "email": {
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        },
                        "id": {
                            "type": "string"
                        },
                        "slug": {
                            "not": {
                                "enum": [
                                    "user-admin",
                                    "user-guest",
                                    "user-actions"
                                ]
                            }
                        },
                        "type": {
                            "const": "user",
                            "type": "string"
                        }
                    },
                    "required": [
                        "id",
                        "type",
                        "data",
                        "slug"
                    ],
                    "type": "object"
                }
            ]
        }
    ],
    "required": [
        "type"
    ],
    "additionalProperties": true
}
